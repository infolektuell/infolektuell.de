---
import { type CollectionEntry, getCollection } from 'astro:content'
import Dinero from 'dinero.js'
import BaseLayout from '@layouts/BaseLayout.astro'
import Header from '@components/products/Header.astro'
import Section from '@components/page/Section.astro'
import ContactButton from '@components/contact/ContactButton.astro'
import TargetGroup from '@components/products/TargetGroup.astro'

export const getStaticPaths = async function () {
  const services = await getCollection('services')
  return services.map((service) => ({
    params: { slug: service.slug },
    props: { service },
  }))
}

type Props = {
  service: CollectionEntry<'services'>
}

const category = 'Dienstleistung'
const { service }: Props = Astro.props
const { title, description, headline, summary, targets, pricePerHour } = service.data
const price = Dinero(pricePerHour).toFormat('$0,0.00')
const { Content } = await service.render()

const openGraph = {
  title: headline ?? title,
  description: summary ?? description,
}
---

<BaseLayout {title} {description} {openGraph}>
  <Header headline={headline ?? title} {summary} {category}>
  </Header>
    <Section title="Zielgruppe">
        <TargetGroup {targets} />
    </Section>
  <Section title="Beschreibung">
    <div class="content">
      <Content />
    </div>
  </Section>
    <Section title="Ãœberzeugt?">
        <ContactButton />
        <dl>
            <dt>Preis pro Stunde</dt>
            <dd>{price}</dd>
        </dl>
    </Section>
</BaseLayout>
